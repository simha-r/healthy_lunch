.alert.alert-danger#new_order_alert{'style'=> "display: none"}
  New order has been received..Reload page to see it !









%table.table
  %thead
    %tr
      %th
        Order #
      %th
        User
      %th
        Address Id
      %th
        Delivery Time
      %th
        State
  - @orders.each do |order|
    %tr
      %td
        = link_to order.id,[:company,order]
      %td
        = order.user.name
      %td
        = order.address_id
      %td
        = order.delivery_time.strftime("%l%p %a %d,%b")
      %td
        = order.state


.row
  = will_paginate @orders






%script{:src => "https://js.pusher.com/2.2/pusher.min.js"}
:javascript
  // Enable pusher logging - don't include this in production
  Pusher.log = function(message) {
    if (window.console && window.console.log) {
      window.console.log(message);
    }
  };

  var pusher = new Pusher("#{Pusher.key}", {
    encrypted: true
  });
  var channel = pusher.subscribe('orders');
  channel.bind('purchased', function(data) {
  var sound = new Howl({
    urls: ['new_order.mp3'],
    loop: true
  }).play();

  $('#new_order_alert').show()

    //sound.stop();
  });